---
title: （二）Redis基础
date: 2020-11-17 23:53:55
tags: REDIS

---

### （二）Redis基础

#### 数据结构

Redis在接受到一个键值对操作后，能以微秒级别的速度查找数据，并快速完成操作

**why?**

- Redis属于内存数据库，所有操作都在内存上完成，速度很快。
- 高效数据结构。

**数据结构有6种：**

/简单动态字符串 /双向链表 /压缩列表 /哈希表 /跳表 /整数数组

/List/Hash/Set/Sorted Set四种数据类型都由两种底层实现结构（集合类型）

一个键值 对应 一个数据类型

##### 1.键和值用什么结构组织

使用了哈希表来保存所有的键值对，称为全局哈希表（哈希表其实就是一个数组，数组的每个元素称为一个哈希桶），哈希桶中保存键值对的数据。

哈希桶中的元素保存的也不是值本身，而是指向具体值的指针。

即：哈希桶中保留的是key和value的指针

---
**?：**哈希冲突导致写入更多数据的时候，操作变慢

**Redis**：采用链式哈希的方式（多个元素用一个链表来保存）

**?：**同样的问题，哈希冲突链上的数据越来越多，查询速度也会受到影响

**Redis：**对哈希表做rehash操作（增加哈希桶数量）

?：rehash操作一次性拷贝大量数据，可能会造成线程阻塞

Redis：采用了渐进式rehash

---

**Rehash操作**

redis使用两个全局哈希表，表1和表2，当使用表1进行rehash操作时

对表2分配比表1更大的空间

把表1中的数据重新映射并拷贝到哈希表2

释放哈希表1的空间

循环利用



**渐进式Rehash**

在拷贝数据时，同时也进行客户端请求的处理，每处理一个请求，从第一个索引开始顺带将索引上的数据，拷贝到另一个哈希表中。等待下一次请求时，在继续拷贝新的索引位置上的数据。